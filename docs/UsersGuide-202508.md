# GSImap 利用者の手引

## はじめに

GSImapは、国土地理院の地形図上にPNG画像を重ね合わせて表示したり、Excel形式のGPS座標データをマーカーで可視化できるWebアプリケーションです。古い地図や計画図面を現在の地形図と比較したい場合や、GPS調査データを地図上で確認したい場合に便利です。

## 基本操作

### アプリケーションの起動

1. `index.html`をWebブラウザで開いてください
2. 画面に国土地理院の地形図が表示されます
3. 初期表示位置は箕面大滝周辺（大阪府）に設定されています

### 地図の基本操作

- **地図の移動**: マウスで地図をドラッグしてください
- **拡大・縮小**: マウスホイールを使用するか、地図左上の「+」「-」ボタンをクリックしてください
- **スケール確認**: 画面右下にスケールバーが表示されています

## 機能別操作方法

### 1. 中心座標の設定

画像を配置したい位置を指定する機能です。

1. 画面右上の「中心座標」ボタンをクリックします
2. ボタンが灰色に変わり、マウスカーソルが十字に変わります
3. 地図上で中心に設定したい場所をクリックします
4. 赤い丸印が表示され、そこが新しい中心座標になります
5. 画面右上に座標値（北緯・東経）が表示されます

### 2. PNG画像の読み込みと表示

地図上にPNG形式の画像を重ね合わせて表示する機能です。

#### 画像の読み込み

1. 「画像(png)読込」ボタンをクリックします
2. ファイル選択ダイアログが開きます
3. PNG形式の画像ファイルを選択します
4. 画像が中心座標を基準に地図上に表示されます

#### 表示倍率の調整

- 「表示倍率」欄に数値を入力します（0.1以上）
- 0.3が標準的な表示サイズです
- 数値が大きいほど画像が大きく表示されます

#### 透過度の調整

- 「透過度(%)」欄に0～100の数値を入力します
- 0: 完全に透明（見えない）
- 50: 半透明（標準）
- 100: 完全に不透明

### 3. 画像の位置・サイズ調整

#### 画像の移動

1. 画像の中心に表示される赤い丸印（中心マーカー）にマウスを合わせます
2. マウスカーソルが移動マーク（十字矢印）に変わります
3. ドラッグして画像全体を移動させます
4. 移動中は座標値がリアルタイムで更新されます

#### 画像のサイズ変更

1. 画像の四隅に表示される赤い丸印（リサイズハンドル）にマウスを合わせます
2. マウスカーソルがリサイズマークに変わります
3. ドラッグして画像のサイズを変更します
4. 縦横比は自動的に維持されます
5. リサイズ中は現在の倍率が画像中心に表示されます

### 4. GPS座標データの表示

Excel形式のGPS座標データをマーカーとして地図上に表示する機能です。

#### Excelファイルの準備

GPS座標を含むExcelファイル（.xlsx形式）を用意します。必要な列は以下の通りです：

**必須の列**
- `緊急ポイント`: マーカーの識別番号（空白の場合、そのデータは表示されません）
- `緯度`: 緯度座標（例：34.853667）
- `経度`: 経度座標（例：135.472041）

**オプションの列**
- `地点`または`場所`または`位置`: 場所の名前（マーカークリック時に表示されます）

#### GPS座標の読み込み

1. 「GPS値(Excel)読込」ボタンをクリックします
2. ファイル選択ダイアログで.xlsxファイルを選択します
3. 有効なGPS座標データが青い逆三角形のマーカーで表示されます
4. マーカーの先端が正確なGPS座標位置に配置されます

#### マーカーの確認

- マーカーをクリックするとポップアップで情報が表示されます
- 表示内容：緊急ポイント番号＋場所名（設定されている場合）

### 5. GeoJSONデータの読み込み

地理的な線・面・点データを表示する機能です。

1. 「GeoJSON読込」ボタンをクリックします
2. .geojsonまたは.json形式のファイルを選択します
3. データがオレンジ色で地図上に表示されます
   - 線・面：オレンジの線で描画
   - 点：オレンジの丸マーカーで表示
4. データに名前情報がある場合、クリックでポップアップ表示されます

## 使用例・応用方法

### 古地図と現在の地図の比較

1. 比較したい場所を中心座標に設定
2. 古地図のPNG画像を読み込み
3. 透過度を50%程度に設定して現在の地形と比較
4. 画像の位置・サイズを調整して正確に重ね合わせ

### 測量・調査データの可視化

1. GPS機器で取得した座標データをExcel形式で整理
2. 必要な列名を設定（緊急ポイント、緯度、経度など）
3. GPS値読み込み機能で一括表示
4. 地図上でデータの分布や位置関係を確認

### 複数データの重ね合わせ

1. 背景として古地図画像を配置
2. GPS調査データをマーカーで表示
3. GeoJSONで境界線や区域を表示
4. 透過度を調整して全てのデータを同時に確認

## 注意事項・制限事項

### ファイル形式について

- **画像ファイル**: PNG形式のみ対応。JPEG、GIF等は使用できません
- **GPS座標ファイル**: Excel形式（.xlsx）のみ対応。CSVファイルは使用できません
- **GeoJSONファイル**: .geojsonまたは.json形式

### ブラウザについて

- Chrome、Firefox、Safari、Microsoft Edgeなどのモダンブラウザをご使用ください
- Internet Explorer 11以前では正常に動作しない可能性があります

### データの保存について

- このアプリケーションはデータを保存しません
- ブラウザを閉じたりページを再読み込みすると、読み込んだデータは消失します
- 必要に応じて元のファイルを保管してください

### 座標系について

- GPS座標は世界測地系（WGS84）の10進数度形式で入力してください
- 度分秒形式には対応していません

## トラブルシューティング

### 画像が表示されない場合

- PNG形式のファイルであることを確認してください
- ファイルが破損していないか確認してください
- ブラウザを再読み込みして再度試してください

### GPS座標が表示されない場合

- Excelファイルの列名が正しいか確認してください
  - 「緊急ポイント」「緯度」「経度」の列が必要です
- 座標値が数値形式で入力されているか確認してください
- 緯度・経度の値が空白でないか確認してください

### 操作が効かない場合

- ブラウザの開発者ツール（F12キー）を開いてエラーメッセージを確認してください
- ページを再読み込み（F5キー）して再度試してください

### 画像の位置がずれる場合

1. 「中心座標」ボタンで正確な中心位置を再設定してください
2. 画像の移動機能（中心の赤い丸印をドラッグ）で微調整してください
3. 表示倍率を調整して適切なサイズに設定してください

## よくある質問（FAQ）

**Q: 複数の画像を同時に表示できますか？**  
A: 現在のバージョンでは、一度に表示できる画像は1枚です。新しい画像を読み込むと前の画像は消えます。

**Q: 画像の回転はできますか？**  
A: 現在のバージョンでは画像の回転機能はありません。事前に画像編集ソフトで回転させてからご使用ください。

**Q: データをファイルに保存できますか？**  
A: 現在のバージョンではデータの保存機能はありません。スクリーンショット機能をご利用ください。

**Q: 海外の地図でも使用できますか？**  
A: 基本的な機能は使用できますが、国土地理院の地図は日本国内のみです。海外では他の地図サービスとの組み合わせが必要です。

## 技術サポート

このアプリケーションは学習・研究目的で開発されたものです。商用利用や重要なプロジェクトでの使用前には、十分なテストを実施してください。

---

*GSImap 利用者の手引*  
*最終更新: 2025年8月10日*  
*バージョン: 1.0*